<div class="cart-container">
  <!-- Boutons de test -->
  <div class="test-controls" style="margin-bottom: 1rem; padding: 1rem; border: 1px dashed #ccc; border-radius: 4px;">
    <h4>Tests du panier :</h4>
    <p-button label="Charger données test" (onClick)="loadTestData()" severity="info" [outlined]="true" [style]="{'margin-right': '0.5rem'}"></p-button>
    <p-button label="Ajouter produit aléatoire" (onClick)="addRandomProduct()" severity="secondary" [outlined]="true" [style]="{'margin-right': '0.5rem'}"></p-button>
    <p-button label="Ajouter tous les produits" (onClick)="addAllProducts()" severity="warning" [outlined]="true"></p-button>
  </div>

  <p-card header="Mon Panier">
    <div *ngIf="cartItems().length === 0" class="empty-cart">
      <p>Votre panier est vide</p>
    </div>
    
    <div *ngIf="cartItems().length > 0">
      <p-table [value]="cartItems()" [tableStyle]="{'min-width': '50rem'}">
        <ng-template pTemplate="header">
          <tr>
            <th>Produit</th>
            <th>Prix unitaire</th>
            <th>Quantité</th>
            <th>Total</th>
            <th>Actions</th>
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-item>
          <tr>
            <td>{{ item.product.name }}</td>
            <td>{{ item.product.price | currency:'EUR' }}</td>
            <td>
              <div class="quantity-controls" [style]="{'display': 'flex', 'align-items': 'center', 'gap': '0.25rem'}">
                <p-button 
                  icon="pi pi-minus" 
                  [disabled]="item.quantity <= 1"
                  size="small"
                  severity="secondary"
                  [outlined]="true"
                  (onClick)="updateQuantity(item.product.id, item.quantity - 1)">
                </p-button>
                <input 
                  type="number" 
                  [(ngModel)]="item.quantity" 
                  [min]="1" 
                  [max]="99"
                  (change)="updateQuantity(item.product.id, item.quantity)"
                  [style]="{'width': '60px', 'text-align': 'center', 'border': '1px solid #ccc', 'border-radius': '4px', 'padding': '0.25rem'}">
                <p-button 
                  icon="pi pi-plus" 
                  [disabled]="item.quantity >= 99"
                  size="small"
                  severity="secondary"
                  [outlined]="true"
                  (onClick)="updateQuantity(item.product.id, item.quantity + 1)">
                </p-button>
              </div>
            </td>
            <td>{{ (item.product.price * item.quantity) | currency:'EUR' }}</td>
            <td>
              <p-button 
                icon="pi pi-trash" 
                severity="danger" 
                [outlined]="true"
                (onClick)="removeFromCart(item.product.id)">
              </p-button>
            </td>
          </tr>
        </ng-template>
      </p-table>
      
      <div class="cart-footer">
        <div class="total-section">
          <h3>Total: {{ totalPrice() | currency:'EUR' }}</h3>
        </div>
        <div class="actions">
          <p-button 
            label="Vider le panier" 
            severity="secondary" 
            [outlined]="true"
            (onClick)="clearCart()">
          </p-button>
          <p-button 
            label="Commander" 
            severity="success">
          </p-button>
        </div>
      </div>
    </div>
  </p-card>
</div>